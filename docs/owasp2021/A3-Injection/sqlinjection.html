<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL &amp; NoSQL Injection | Web Security Workbook</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.svg">
    <meta name="description" content="Workbook for secure web-applications">
    
    <link rel="preload" href="/assets/css/0.styles.d3c84d71.css" as="style"><link rel="preload" href="/assets/js/app.85caaa41.js" as="script"><link rel="preload" href="/assets/js/2.480740af.js" as="script"><link rel="preload" href="/assets/js/24.4ecb970a.js" as="script"><link rel="preload" href="/assets/js/4.427d56c9.js" as="script"><link rel="prefetch" href="/assets/js/10.59739b1d.js"><link rel="prefetch" href="/assets/js/11.bdbd0355.js"><link rel="prefetch" href="/assets/js/12.c0593824.js"><link rel="prefetch" href="/assets/js/13.cfdbf5e7.js"><link rel="prefetch" href="/assets/js/14.5a27ed33.js"><link rel="prefetch" href="/assets/js/15.3ae224e5.js"><link rel="prefetch" href="/assets/js/16.5cdb6f07.js"><link rel="prefetch" href="/assets/js/17.0f0ffeb3.js"><link rel="prefetch" href="/assets/js/18.efa8ecc6.js"><link rel="prefetch" href="/assets/js/19.cfc55202.js"><link rel="prefetch" href="/assets/js/20.15537e7a.js"><link rel="prefetch" href="/assets/js/21.4c0e36d5.js"><link rel="prefetch" href="/assets/js/22.4da9c62f.js"><link rel="prefetch" href="/assets/js/23.9d28d7a2.js"><link rel="prefetch" href="/assets/js/25.0b0882f4.js"><link rel="prefetch" href="/assets/js/26.58b14f51.js"><link rel="prefetch" href="/assets/js/27.51d6fa71.js"><link rel="prefetch" href="/assets/js/28.6321ad7b.js"><link rel="prefetch" href="/assets/js/29.651b2875.js"><link rel="prefetch" href="/assets/js/3.2d28240e.js"><link rel="prefetch" href="/assets/js/30.c324224c.js"><link rel="prefetch" href="/assets/js/31.450b8a8a.js"><link rel="prefetch" href="/assets/js/32.ffd9a6f9.js"><link rel="prefetch" href="/assets/js/33.d6bb1f13.js"><link rel="prefetch" href="/assets/js/34.df9c4512.js"><link rel="prefetch" href="/assets/js/35.c51dd923.js"><link rel="prefetch" href="/assets/js/36.499b80c1.js"><link rel="prefetch" href="/assets/js/37.d890812a.js"><link rel="prefetch" href="/assets/js/38.b9691323.js"><link rel="prefetch" href="/assets/js/39.72626061.js"><link rel="prefetch" href="/assets/js/40.3fd6d525.js"><link rel="prefetch" href="/assets/js/41.49853c5d.js"><link rel="prefetch" href="/assets/js/5.5a7c7628.js"><link rel="prefetch" href="/assets/js/6.16ef11dd.js"><link rel="prefetch" href="/assets/js/7.43b93d5e.js"><link rel="prefetch" href="/assets/js/8.278718f6.js"><link rel="prefetch" href="/assets/js/9.9ea22962.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d3c84d71.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Web Security Workbook" class="logo"> <span class="site-name can-hide">Web Security Workbook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/owasp2021/" class="nav-link router-link-active">
  OWASP 2021
</a></div><div class="nav-item"><a href="/general/" class="nav-link">
  General
</a></div><div class="nav-item"><a href="/codeExamples.html" class="nav-link">
  Code Examples
</a></div><div class="nav-item"><a href="/imprint.html" class="nav-link">
  Imprint
</a></div><div class="nav-item"><a href="https://www.msg.group/en/privacy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Data Privacy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/owasp2021/" class="nav-link router-link-active">
  OWASP 2021
</a></div><div class="nav-item"><a href="/general/" class="nav-link">
  General
</a></div><div class="nav-item"><a href="/codeExamples.html" class="nav-link">
  Code Examples
</a></div><div class="nav-item"><a href="/imprint.html" class="nav-link">
  Imprint
</a></div><div class="nav-item"><a href="https://www.msg.group/en/privacy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Data Privacy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/owasp2021/" aria-current="page" class="sidebar-link">OWASP Top 10 2021</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A1: Broken Access Control</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A2: Cryptographic Failures</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>A3: Injection</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/owasp2021/A3-Injection/" aria-current="page" class="sidebar-link">General Information</a></li><li><a href="/owasp2021/A3-Injection/sqlinjection.html" aria-current="page" class="active sidebar-link">SQL &amp; NoSQL Injection</a></li><li><a href="/owasp2021/A3-Injection/xss.html" class="sidebar-link">Cross-Site Scripting (XSS)</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A4: Insecure Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A5: Security Misconfiguration</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A6: Vulnerable and Outdated Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A7: Identification and Authentication Failures</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A8: Software and Data Integrity Failures</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A9: Security Logging and Monitoring Failures</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A10: Server-Side Request Forgery (SSRF)</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="page-title"><a href="#page-title" class="header-anchor">#</a> SQL &amp; NoSQL Injection</h1> <p>SQL and NoSQL Injection are attacks in which Code is injected into database queries in order to change their outcome.</p> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>A03:2021</span> <h2 id="background"><a href="#background" class="header-anchor">#</a> Background</h2> <h3 id="context"><a href="#context" class="header-anchor">#</a> Context</h3> <p>Injection attacks are possible if database queries are created based on user input. Consequently, the user gains control over the behavior of the query through the added code or commands. The best known types of such an injection are SQL injections, which take place on relational databases such as MySQL, and NoSQL injections which can happen in a variety of databases such as MongoDB or Redis.</p> <p>The following mechanisms were defined to inject code into databases:</p> <ul><li>User input</li> <li>Cookies</li> <li>Server variables</li> <li>Second-order injections (execution of injection is postponed)</li></ul> <h4 id="sql-injection"><a href="#sql-injection" class="header-anchor">#</a> SQL Injection</h4> <p>In SQL injections attackers inject data into SQL queries to change their outcome. An example can be seen in the following:</p> <div class="language-js extra-class"><pre class="language-js"><code>connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
    <span class="token string">&quot;SELECT * from user WHERE name = '&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;' OR 1=1&quot;</span><span class="token punctuation">,</span>
     <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> rows<span class="token punctuation">,</span> fields</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre></div><p>The user input (2. String) is concatenated to the SQL query without further escaping and therefore changes the query's outcome. The induced behaviour causes the WHERE clause to always be true and thus always return all users.</p> <p>In the literature different types of SQL injections could be elaborated:</p> <table><thead><tr><th>Type</th> <th>Example</th></tr></thead> <tbody><tr><td>Tautologies</td> <td>OR 1 = 1</td></tr> <tr><td>Union queries</td> <td>; UNION SELECT * FROM SecretTable</td></tr> <tr><td>Piggyback queries</td> <td>; DROP SecretTable</td></tr> <tr><td>Incorrect queries</td> <td>OR OR OR OR</td></tr> <tr><td>Extending queries</td> <td>sqlcmd</td></tr></tbody></table> <h4 id="nosql-injection"><a href="#nosql-injection" class="header-anchor">#</a> NoSQL Injection</h4> <p>A NoSQL injection functions similar to a SQL injection. An example can be seen in the following:</p> <div class="language-js extra-class"><pre class="language-js"><code>collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{&quot;$ne&quot;: &quot; &quot;}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>The query searches for all titles within its collection which are not equal to an empty string. The resulting dataset contains all titles.</p> <p>Different types of NoSQL injections exist. However, these are again similar to the SQL injection types:</p> <table><thead><tr><th>Type</th> <th>Example</th></tr></thead> <tbody><tr><td>Operator injections (creates e.g. tautologies)</td> <td>{$ne: {''}}</td></tr> <tr><td>JavaScript injections (creates e.g. tautologies)</td> <td>$where: &quot;...&quot;</td></tr> <tr><td>Piggyback queries</td> <td>&quot;$or&quot;</td></tr></tbody></table> <h3 id="issues"><a href="#issues" class="header-anchor">#</a> Issues</h3> <ul><li>Data could be stolen through attacks which use tautologies or piggyback injections</li> <li>Data could also be lost or changed to the advantage of the attacker (elevation of privilege)</li> <li>Successful attacks can not only attack databases but also their underlying systems and infrastructure</li></ul> <h3 id="solutions"><a href="#solutions" class="header-anchor">#</a> Solutions</h3> <ul><li>Parameterized queries (e.g. via ORMs)</li> <li>Usage of secure APIs</li> <li>Escaping or sanitization (<a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">OWASP SQL Injection Cheat Sheet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li> <li>Using of client-directed queries (GraphQL)</li></ul> <h2 id="technology"><a href="#technology" class="header-anchor">#</a> Technology</h2> <p>To connect a framework with a database, the usage of a library is most often indispensable. These libraries will be evaluated in the following.</p> <p>Your favorite framework/library/database is missing? <a href="https://vc.hub.msg.team/huethm/web-security-workbook" target="_blank" rel="noopener noreferrer">Add it yourself!<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="express"><a href="#express" class="header-anchor">#</a> Express</h3> <h4 id="mysql-database"><a href="#mysql-database" class="header-anchor">#</a> MySQL database</h4> <p><a href="https://www.npmjs.com/package/mysql" target="_blank" rel="noopener noreferrer">mysql<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The library <em>mysql</em> can be used to connect an Express server with and MySQL database. The following shows recommended querying of data:</p> <div class="language-js extra-class"><pre class="language-js"><code>connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
    <span class="token string">&quot;SELECT * FROM user WHERE name = &quot;</span> <span class="token operator">+</span> connection<span class="token punctuation">.</span><span class="token function">escape</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> rows<span class="token punctuation">,</span> fields</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
    <span class="token string">&quot;SELECT * from user WHERE name = ?&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span>input<span class="token punctuation">]</span><span class="token punctuation">,</span> 
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> rows<span class="token punctuation">,</span> fields</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>The <em>escape()</em> Methode escapes potentially dangerous code
<ul><li><em>NO_BACKSLASH_ESCAPE</em> needs to be disabled, otherwise the backslash character cannot be used for escaping</li></ul></li> <li>? are placeholder for user input which is escaped before its added to the SQL query</li></ul></div> <p><a href="https://www.npmjs.com/package/sequelize" target="_blank" rel="noopener noreferrer">Sequelize<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><em>Sequelize</em> is <a href="https://www.npmjs.com/search?q=orm" target="_blank" rel="noopener noreferrer">one of many ORMs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> which are available on <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npmjs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. ORMs function through the definition of a model which represents data inside of the database. Therefore, parameters, which are passed to the database, can be given a datatype to which the parameter is parsed to.</p> <p><strong>As a result, queries are secure.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> User <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> 
<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/getUser'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    User<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;' OR 1=1 --&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>    
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="mongodb-database"><a href="#mongodb-database" class="header-anchor">#</a> MongoDB database</h4> <p>When working with MongoDB, the most common libraries are <a href="https://www.npmjs.com/package/mongodb" target="_blank" rel="noopener noreferrer">mongodb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://www.npmjs.com/package/mongoose" target="_blank" rel="noopener noreferrer">mongoose<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (ORM).</p> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p><strong>The usage is insecure if no sanitization library is used. Attacks possible through <a href="/owasp2021/A3-Injection/#context">operator injections</a>.</strong></p></div> <p><strong>Solution:</strong> The usage of sanitization libraries such as <a href="https://www.npmjs.com/package/express-mongo-sanitize" target="_blank" rel="noopener noreferrer">express-mongo-sanitize<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://www.npmjs.com/package/mongo-sanitize" target="_blank" rel="noopener noreferrer">mongo-sanitize<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. The former prior library is the preferred choice since it functions with Express' middleware and adds therefore more Security By Default.</p> <h3 id="spring-boot"><a href="#spring-boot" class="header-anchor">#</a> Spring Boot</h3> <h4 id="mysql-database-2"><a href="#mysql-database-2" class="header-anchor">#</a> MySQL database</h4> <p>In Java, different ways of querying data from a MySQL database exist. Both Java's <code>mysql-connector-java</code> and Spring's <code>spring-boot-starter-data-jdbc</code> offer secure data querying with <code>PreparedStatement</code>'s or <code>NamedParameterJdbcTemplate</code>'s. However, queries can also be created insecurely. In contrast, <code>spring-boot-starter-data-jpa</code> can be used as ORM by defining <code>Entity</code> classes making the queries secure.</p> <h4 id="mongodb-database-2"><a href="#mongodb-database-2" class="header-anchor">#</a> MongoDB database</h4> <p>When using MongoDB as underlying database, a Spring Boot developer will most likely use <code>spring-boot-starter-data-jpa</code>. While testing and researching for potential security issues, none were found.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/owasp2021/A3-Injection/" class="prev router-link-active">
        General Information
      </a></span> <span class="next"><a href="/owasp2021/A3-Injection/xss.html">
        Cross-Site Scripting (XSS)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.85caaa41.js" defer></script><script src="/assets/js/2.480740af.js" defer></script><script src="/assets/js/24.4ecb970a.js" defer></script><script src="/assets/js/4.427d56c9.js" defer></script>
  </body>
</html>
