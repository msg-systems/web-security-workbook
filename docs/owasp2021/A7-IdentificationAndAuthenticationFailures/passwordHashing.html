<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Passwort Hashing | Web Security Workbook</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.svg">
    <meta name="description" content="Workbook for secure web-applications">
    
    <link rel="preload" href="/assets/css/0.styles.7a69eaf4.css" as="style"><link rel="preload" href="/assets/js/app.de647d12.js" as="script"><link rel="preload" href="/assets/js/2.480740af.js" as="script"><link rel="preload" href="/assets/js/33.92642257.js" as="script"><link rel="preload" href="/assets/js/4.427d56c9.js" as="script"><link rel="prefetch" href="/assets/js/10.ffd738e0.js"><link rel="prefetch" href="/assets/js/11.36b681dd.js"><link rel="prefetch" href="/assets/js/12.f96d5720.js"><link rel="prefetch" href="/assets/js/13.cfdbf5e7.js"><link rel="prefetch" href="/assets/js/14.c517a2ed.js"><link rel="prefetch" href="/assets/js/15.3ae224e5.js"><link rel="prefetch" href="/assets/js/16.5cdb6f07.js"><link rel="prefetch" href="/assets/js/17.0d787b69.js"><link rel="prefetch" href="/assets/js/18.0b1ea511.js"><link rel="prefetch" href="/assets/js/19.76f34e01.js"><link rel="prefetch" href="/assets/js/20.78d8fa11.js"><link rel="prefetch" href="/assets/js/21.c2550716.js"><link rel="prefetch" href="/assets/js/22.ef94104e.js"><link rel="prefetch" href="/assets/js/23.336d2734.js"><link rel="prefetch" href="/assets/js/24.5e12ba29.js"><link rel="prefetch" href="/assets/js/25.3686d7f6.js"><link rel="prefetch" href="/assets/js/26.29b17b2e.js"><link rel="prefetch" href="/assets/js/27.faf574cc.js"><link rel="prefetch" href="/assets/js/28.413736a5.js"><link rel="prefetch" href="/assets/js/29.bedfe749.js"><link rel="prefetch" href="/assets/js/3.2d28240e.js"><link rel="prefetch" href="/assets/js/30.81a333a2.js"><link rel="prefetch" href="/assets/js/31.450b8a8a.js"><link rel="prefetch" href="/assets/js/32.60ae5b1c.js"><link rel="prefetch" href="/assets/js/34.32c2151a.js"><link rel="prefetch" href="/assets/js/35.3d137c87.js"><link rel="prefetch" href="/assets/js/36.d89c0659.js"><link rel="prefetch" href="/assets/js/37.d890812a.js"><link rel="prefetch" href="/assets/js/38.b9691323.js"><link rel="prefetch" href="/assets/js/39.72626061.js"><link rel="prefetch" href="/assets/js/40.e98f294f.js"><link rel="prefetch" href="/assets/js/41.daff198f.js"><link rel="prefetch" href="/assets/js/5.5a7c7628.js"><link rel="prefetch" href="/assets/js/6.16ef11dd.js"><link rel="prefetch" href="/assets/js/7.43b93d5e.js"><link rel="prefetch" href="/assets/js/8.b4f8ad6b.js"><link rel="prefetch" href="/assets/js/9.c77f72a2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7a69eaf4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Web Security Workbook" class="logo"> <span class="site-name can-hide">Web Security Workbook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/owasp2021/" class="nav-link router-link-active">
  OWASP 2021
</a></div><div class="nav-item"><a href="/general/" class="nav-link">
  General
</a></div><div class="nav-item"><a href="/codeExamples.html" class="nav-link">
  Code Examples
</a></div><div class="nav-item"><a href="/imprint.html" class="nav-link">
  Imprint
</a></div><div class="nav-item"><a href="https://www.msg.group/en/privacy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Data Privacy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/owasp2021/" class="nav-link router-link-active">
  OWASP 2021
</a></div><div class="nav-item"><a href="/general/" class="nav-link">
  General
</a></div><div class="nav-item"><a href="/codeExamples.html" class="nav-link">
  Code Examples
</a></div><div class="nav-item"><a href="/imprint.html" class="nav-link">
  Imprint
</a></div><div class="nav-item"><a href="https://www.msg.group/en/privacy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Data Privacy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/owasp2021/" aria-current="page" class="sidebar-link">OWASP Top 10 2021</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A1: Broken Access Control</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A2: Cryptographic Failures</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A3: Injection</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A4: Insecure Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A5: Security Misconfiguration</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A6: Vulnerable and Outdated Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>A7: Identification and Authentication Failures</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/owasp2021/A7-IdentificationAndAuthenticationFailures/" aria-current="page" class="sidebar-link">General Information</a></li><li><a href="/owasp2021/A7-IdentificationAndAuthenticationFailures/jsonWebToken.html" class="sidebar-link">JSON Web Token (JWT)</a></li><li><a href="/owasp2021/A7-IdentificationAndAuthenticationFailures/passwordHashing.html" aria-current="page" class="active sidebar-link">Passwort Hashing</a></li><li><a href="/owasp2021/A7-IdentificationAndAuthenticationFailures/passwordPolicy.html" class="sidebar-link">Password Policies</a></li><li><a href="/owasp2021/A7-IdentificationAndAuthenticationFailures/sessionCookies.html" class="sidebar-link">Session Cookies</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A8: Software and Data Integrity Failures</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A9: Security Logging and Monitoring Failures</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A10: Server-Side Request Forgery (SSRF)</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="page-title"><a href="#page-title" class="header-anchor">#</a> Passwort Hashing</h1> <p>To make passwords save from offline attacks, they need to be hashed. Therefore, in case data is stolen the damage can be reduced.</p> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>A07:2021</span> <h2 id="background"><a href="#background" class="header-anchor">#</a> Background</h2> <h3 id="context"><a href="#context" class="header-anchor">#</a> Context</h3> <p>In case a web application was attacked successfully and user data was lost, attackers are not able to directly use the gathered usernames and passwords since the hash cannot be used to recreate the password. Furthermore, salting should be used to protect the passwords from recreation with Rainbow-Tables. The salt, which is an randomly generated string, is added to the password hashed with it. Consequently, similar passwords do not result in the same hash.</p> <p>The hash function requires the hashed password, the salt and a work factor (rounds of hashing). Different recommendations for the selection of the correct hash function, the length of the salt and the length of the secret can be found bellow:</p> <ul><li><a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102.pdf?__blob=publicationFile" target="_blank" rel="noopener noreferrer">BSI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://pages.nist.gov/800-63-3/sp800-63b.html" target="_blank" rel="noopener noreferrer">NIST<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">OWASP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Recommended password hashing algorithms:</p> <ul><li>BSI: <strong>Argon2id</strong></li> <li>NIST: PBKDF2</li> <li>OWASP: <strong>Argon2id</strong> &gt; bcrypt</li></ul> <p>Configuration of Argon2id based on OWASP (BSI does not define concrete configuration):</p> <ul><li>Memory size = 15 MiB</li> <li>Iterations = 1</li> <li>Degree of parallelism = 1</li></ul> <h3 id="problems"><a href="#problems" class="header-anchor">#</a> Problems</h3> <ul><li>Incorrectly implemented hashing</li> <li>Complicated configuration of algorithms</li></ul> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p><strong>Never do it yourself!</strong></p></div> <h3 id="solutions"><a href="#solutions" class="header-anchor">#</a> Solutions</h3> <ul><li>Usage of libraries that offer secure default configuration</li> <li>If possible: Use other tools that handle password storage</li></ul> <h2 id="technology"><a href="#technology" class="header-anchor">#</a> Technology</h2> <p>Configuration examples exist for both <a href="https://github.com/moritzhuether/mastersthesis/blob/main/GeneralJS/pwHashing.js" target="_blank" rel="noopener noreferrer">Node.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://github.com/moritzhuether/mastersthesis/blob/main/SpringBoot/demo/src/main/java/main/demo/WebSecurityConfig.java" target="_blank" rel="noopener noreferrer">Spring Boot<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="node-js"><a href="#node-js" class="header-anchor">#</a> Node.js</h3> <p>The usage of the library <a href="https://www.npmjs.com/package/argon2" target="_blank" rel="noopener noreferrer">argon2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is recommended. However, if OWASP's recommendations are considered, the library has to be configured as shown in the following:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>argon2<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>
    password<span class="token punctuation">,</span> 
    <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span> <span class="token operator">:</span> argon2<span class="token punctuation">.</span>argon2id<span class="token punctuation">,</span> 
        <span class="token literal-property property">timeCost</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">memoryCost</span><span class="token operator">:</span> <span class="token number">15360</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">parallelism</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="spring-boot"><a href="#spring-boot" class="header-anchor">#</a> Spring Boot</h3> <p>In Spring Boot one can use the <a href="https://docs.spring.io/spring-security/site/docs/3.2.5.RELEASE/apidocs/org/springframework/security/crypto/password/PasswordEncoder.html" target="_blank" rel="noopener noreferrer">PasswordEncoder<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> interface. It offers high Security by Default by perfectly implementing OWASP's recommendations.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/owasp2021/A7-IdentificationAndAuthenticationFailures/jsonWebToken.html" class="prev">
        JSON Web Token (JWT)
      </a></span> <span class="next"><a href="/owasp2021/A7-IdentificationAndAuthenticationFailures/passwordPolicy.html">
        Password Policies
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.de647d12.js" defer></script><script src="/assets/js/2.480740af.js" defer></script><script src="/assets/js/33.92642257.js" defer></script><script src="/assets/js/4.427d56c9.js" defer></script>
  </body>
</html>
