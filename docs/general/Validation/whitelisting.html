<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Use Whitelisting instead of Blacklisting | Web Security Workbook</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.svg">
    <meta name="description" content="Workbook for secure web-applications">
    
    <link rel="preload" href="/assets/css/0.styles.d3c84d71.css" as="style"><link rel="preload" href="/assets/js/app.04ccda12.js" as="script"><link rel="preload" href="/assets/js/2.480740af.js" as="script"><link rel="preload" href="/assets/js/17.83173ca1.js" as="script"><link rel="prefetch" href="/assets/js/10.59739b1d.js"><link rel="prefetch" href="/assets/js/11.98a82ac0.js"><link rel="prefetch" href="/assets/js/12.baf3f784.js"><link rel="prefetch" href="/assets/js/13.28a41285.js"><link rel="prefetch" href="/assets/js/14.fe2a4529.js"><link rel="prefetch" href="/assets/js/15.a573fcd3.js"><link rel="prefetch" href="/assets/js/16.f33f1e13.js"><link rel="prefetch" href="/assets/js/18.760b7ef7.js"><link rel="prefetch" href="/assets/js/19.12e08c1b.js"><link rel="prefetch" href="/assets/js/20.cc3f6226.js"><link rel="prefetch" href="/assets/js/21.4c0e36d5.js"><link rel="prefetch" href="/assets/js/22.4da9c62f.js"><link rel="prefetch" href="/assets/js/23.eb69c8a1.js"><link rel="prefetch" href="/assets/js/24.d065cc45.js"><link rel="prefetch" href="/assets/js/25.3686d7f6.js"><link rel="prefetch" href="/assets/js/26.77b70151.js"><link rel="prefetch" href="/assets/js/27.07c87283.js"><link rel="prefetch" href="/assets/js/28.6321ad7b.js"><link rel="prefetch" href="/assets/js/29.432d4814.js"><link rel="prefetch" href="/assets/js/3.2d28240e.js"><link rel="prefetch" href="/assets/js/30.c324224c.js"><link rel="prefetch" href="/assets/js/31.900ef39e.js"><link rel="prefetch" href="/assets/js/32.60ae5b1c.js"><link rel="prefetch" href="/assets/js/33.db950898.js"><link rel="prefetch" href="/assets/js/34.120e659f.js"><link rel="prefetch" href="/assets/js/35.3d137c87.js"><link rel="prefetch" href="/assets/js/36.499b80c1.js"><link rel="prefetch" href="/assets/js/37.fc4a2f27.js"><link rel="prefetch" href="/assets/js/38.a34b827f.js"><link rel="prefetch" href="/assets/js/39.72626061.js"><link rel="prefetch" href="/assets/js/4.427d56c9.js"><link rel="prefetch" href="/assets/js/40.e98f294f.js"><link rel="prefetch" href="/assets/js/41.257565cb.js"><link rel="prefetch" href="/assets/js/5.5a7c7628.js"><link rel="prefetch" href="/assets/js/6.16ef11dd.js"><link rel="prefetch" href="/assets/js/7.43b93d5e.js"><link rel="prefetch" href="/assets/js/8.278718f6.js"><link rel="prefetch" href="/assets/js/9.91aa744f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d3c84d71.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Web Security Workbook" class="logo"> <span class="site-name can-hide">Web Security Workbook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/owasp2021/" class="nav-link">
  OWASP 2021
</a></div><div class="nav-item"><a href="/general/" class="nav-link router-link-active">
  General
</a></div><div class="nav-item"><a href="/codeExamples.html" class="nav-link">
  Code Examples
</a></div><div class="nav-item"><a href="/imprint.html" class="nav-link">
  Imprint
</a></div><div class="nav-item"><a href="https://www.msg.group/en/privacy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Data Privacy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/owasp2021/" class="nav-link">
  OWASP 2021
</a></div><div class="nav-item"><a href="/general/" class="nav-link router-link-active">
  General
</a></div><div class="nav-item"><a href="/codeExamples.html" class="nav-link">
  Code Examples
</a></div><div class="nav-item"><a href="/imprint.html" class="nav-link">
  Imprint
</a></div><div class="nav-item"><a href="https://www.msg.group/en/privacy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Data Privacy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/general/" aria-current="page" class="sidebar-link">General Tips &amp; Tricks</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Denial of Service</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Secure Engineering</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Validation</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/general/Validation/" aria-current="page" class="sidebar-link">Validation</a></li><li><a href="/general/Validation/openRedirectsAndForwards.html" class="sidebar-link">Open Redirects and Forwards</a></li><li><a href="/general/Validation/whitelisting.html" aria-current="page" class="active sidebar-link">Use Whitelisting instead of Blacklisting</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="page-title"><a href="#page-title" class="header-anchor">#</a> Use Whitelisting instead of Blacklisting</h1> <p>Allowing only certain inputs is more secure than only disallowing certain inputs.</p> <h2 id="background"><a href="#background" class="header-anchor">#</a> Background</h2> <p>Whitelisting describes the definition of a list of inputs that are allowed. Blacklisting on the other hand, defines a list of inputs which are not allowed. Consequently, blacklisting can open the system to input that were not thought of in the first place. The selection of whitelisting will remove this threat by generally disallowing everything that is not required and therefore not in the list.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Generate a regular expression or an enumeration of valid values to whitelist data</p></div> <p>Following example demonstrated the problem with blacklisting. Even though its <code>if</code> contains a lot more constraints, the whitelisting approach still is more restrictive.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Only red, blue and yellow allowed</span>

<span class="token comment">// User selected color</span>
<span class="token keyword">let</span> color <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span>

<span class="token comment">// Whitelisting</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;yellow&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Valid&quot;</span><span class="token punctuation">)</span>

<span class="token comment">//Whitelisting with RegEx</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>color<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">&quot;^(red|blue|yellow)$&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Valid&quot;</span><span class="token punctuation">)</span>

<span class="token comment">//Blacklisting</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pink&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;purple&quot;</span><span class="token punctuation">,</span> 
    <span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;turquoise&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;brown&quot;</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Valid&quot;</span><span class="token punctuation">)</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/general/Validation/openRedirectsAndForwards.html" class="prev">
        Open Redirects and Forwards
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.04ccda12.js" defer></script><script src="/assets/js/2.480740af.js" defer></script><script src="/assets/js/17.83173ca1.js" defer></script>
  </body>
</html>
