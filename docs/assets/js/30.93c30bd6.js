(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{459:function(t,a,s){"use strict";s.r(a);var e=s(65),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"page-title"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[t._v("#")]),t._v(" "+t._s(t.$page.title))]),t._v(" "),s("p",[t._v(t._s(t.$page.frontmatter.excerpt))]),t._v(" "),s("Badge",{attrs:{text:t.$page.frontmatter.owasp}}),t._v(" "),s("h2",{attrs:{id:"background"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[t._v("#")]),t._v(" Background")]),t._v(" "),s("h3",{attrs:{id:"context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[t._v("#")]),t._v(" Context")]),t._v(" "),s("p",[t._v("XXE attacks are possible if the used XML parser is not configured securely. In case the referencing of external entities is allowed security issues can arise. Entities are defined in the following format:")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("!ENTITY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('"An')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('occured"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("Via "),s("code",[t._v("&error;")]),t._v(" the entity can be used inside of the XML document.")]),t._v(" "),s("h3",{attrs:{id:"problems"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#problems"}},[t._v("#")]),t._v(" Problems")]),t._v(" "),s("ul",[s("li",[t._v("Through recursive referencing on entities attackers can increase CPU usage and make the server unresponsive. The Billion Laughs Attack is an attack which uses this pattern to deny a server's service. It references "),s("code",[t._v("&LOLX;")]),t._v(" entities over and over as seen in the example below:")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token doctype"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),s("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token name"}},[t._v("root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token internal-subset"}},[t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("!ELEMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ANY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("!ENTITY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("LOL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('"lol"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("!ENTITY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("LOL1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('"&LOL;&LOL;&LOL;&LOL;&LOL;&LOL;&LOL;&LOL;&LOL;&LOL;"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("!ENTITY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("LOL2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('"&LOL1;&LOL1;&LOL1;&LOL1;&LOL1;&LOL1;&LOL1;&LOL1;&LOL1;')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("6")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('&LOL1;"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n...\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("!ENTITY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("LOL9")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('"&LOL8;&LOL8;&LOL8;&LOL8;&LOL8;&LOL8;&LOL8;&LOL8;&LOL8;')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('&LOL8;"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token entity named-entity",title:"&LOL9;"}},[t._v("&LOL9;")]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("Additionally, the "),s("em",[t._v("SYSTEM")]),t._v(" keyword can be used to load external files or read internal data such as passwords")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>\n')])])]),s("h3",{attrs:{id:"solutions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#solutions"}},[t._v("#")]),t._v(" Solutions")]),t._v(" "),s("ul",[s("li",[t._v("Restrict the parsers underlying resources")]),t._v(" "),s("li",[t._v("Use parsers that contain security mechanisms that "),s("strong",[t._v("ignore external entities")])])]),t._v(" "),s("h2",{attrs:{id:"technologies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#technologies"}},[t._v("#")]),t._v(" Technologies")]),t._v(" "),s("p",[t._v("Your favorite parser is missing? "),s("a",{attrs:{href:"https://websecurityworkbook.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Add it yourself!"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("As described above, the parser should not be exploitable by external entities.")]),t._v(" "),s("h3",{attrs:{id:"node-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-js"}},[t._v("#")]),t._v(" Node.js")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Library")]),t._v(" "),s("th",[t._v("Solution")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("em",[t._v("sax")])]),t._v(" "),s("td",[t._v("Setting its mode to "),s("em",[t._v("strict")]),t._v(" is required. "),s("a",{attrs:{href:"https://github.com/moritzhuether/mastersthesis/blob/main/GeneralJS/xxe.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Code example"),s("OutboundLink")],1)])])])]),t._v(" "),s("h3",{attrs:{id:"java"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java"}},[t._v("#")]),t._v(" Java")]),t._v(" "),s("p",[t._v("See "),s("a",{attrs:{href:"https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java",target:"_blank",rel:"noopener noreferrer"}},[t._v("OWASP's Cheat Sheet"),s("OutboundLink")],1)])],1)}),[],!1,null,null,null);a.default=r.exports}}]);