(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{461:function(t,e,a){"use strict";a.r(e);var s=a(65),o=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"page-title"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[t._v("#")]),t._v(" "+t._s(t.$page.title))]),t._v(" "),a("Badge",{attrs:{text:t.$page.frontmatter.owasp}}),t._v(" "),a("h2",{attrs:{id:"background"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[t._v("#")]),t._v(" Background")]),t._v(" "),a("h3",{attrs:{id:"context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[t._v("#")]),t._v(" Context")]),t._v(" "),a("p",[t._v("JTWs are a standard that is defined in "),a("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc7519",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 7519"),a("OutboundLink")],1),t._v(". The token consists of a header, a payload and a signature. Within its header, metainformation about the token, such as the used hashing algorithm or the type of the JWT. Its payload carries data that is required by the application. Both of these components are Base64 encoded and concatenated with a dot. This string is not only used to start the JWT but also used in the signature in which a HMAC function is used to create a hash of it. The resulting hash is concatenated to the above mentioned string.")]),t._v(" "),a("h3",{attrs:{id:"problems"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#problems"}},[t._v("#")]),t._v(" Problems")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("In case the validation is influenced by the "),a("code",[t._v("alg")]),t._v(" attribute, an attacker can dodge the validation or manipulate it.")]),t._v(" "),a("ul",[a("li",[t._v("Insecure libraries except "),a("code",[t._v("none")]),t._v(" as algorithm, causing the JWT to always be valid.")]),t._v(" "),a("li",[t._v("Also allows the forging of new JWTs if for example RSA was used for encryption.\n"),a("ul",[a("li",[t._v("Attackers switch from RSA to HMAC and encrypt a new token with the public key used in RSA")]),t._v(" "),a("li",[t._v("The library now switches from RSA to HMAC because of the changed header and uses the public key as secret")]),t._v(" "),a("li",[t._v("The token is valid because the attacker used the public key to encrypt the token")])])])])]),t._v(" "),a("li",[a("strong",[t._v("Storing of JWTs is not included in the standard")])]),t._v(" "),a("li",[a("strong",[t._v("Tokens cannot be revoked")]),t._v(" "),a("ul",[a("li",[t._v("Implementation of token blacklist is possible but then session cookies can be used instead")])])]),t._v(" "),a("li",[a("strong",[t._v("Stolen JWTs (trough for example XSS) can therefore be used to authenticate requests")])])]),t._v(" "),a("h3",{attrs:{id:"solution"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#solution"}},[t._v("#")]),t._v(" Solution")]),t._v(" "),a("ul",[a("li",[t._v("Usage of secure libraries that only allow certain "),a("code",[t._v("alg")]),t._v(" values")]),t._v(" "),a("li",[t._v("Usage of other authentication methods")])]),t._v(" "),a("h2",{attrs:{id:"technology"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#technology"}},[t._v("#")]),t._v(" Technology")]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("DANGER")]),t._v(" "),a("p",[a("strong",[t._v("All problems except the first two are native to JWTs and not solvable")])])]),t._v(" "),a("h3",{attrs:{id:"node-js-libraries"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-js-libraries"}},[t._v("#")]),t._v(" Node.js Libraries")]),t._v(" "),a("p",[t._v("The first of the above described problems is solved through the "),a("a",{attrs:{href:"https://www.npmjs.com/package/jsonwebtoken",target:"_blank",rel:"noopener noreferrer"}},[t._v("jsonwebtoken"),a("OutboundLink")],1),t._v(" library. The parameter that is passed to the  "),a("em",[t._v("verify")]),t._v(" method is evaluated whether its content is a public key or not. If it is a public key, the RSA encryption is used and if not, the string is used as secret and only HMAC based encryption is used.")]),t._v(" "),a("h3",{attrs:{id:"java"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java"}},[t._v("#")]),t._v(" Java")]),t._v(" "),a("p",[t._v("The libraries available in Java "),a("a",{attrs:{href:"https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt",target:"_blank",rel:"noopener noreferrer"}},[t._v("io.jsonwebtoken"),a("OutboundLink")],1),t._v(" or "),a("a",{attrs:{href:"https://mvnrepository.com/artifact/com.auth0/java-jwt",target:"_blank",rel:"noopener noreferrer"}},[t._v("java-jwt"),a("OutboundLink")],1),t._v(" work similar.")])],1)}),[],!1,null,null,null);e.default=o.exports}}]);