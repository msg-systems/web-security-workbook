(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{467:function(e,t,a){"use strict";a.r(t);var r=a(65),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"page-title"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[e._v("#")]),e._v(" "+e._s(e.$page.title))]),e._v(" "),a("p",[e._v(e._s(e.$page.frontmatter.excerpt))]),e._v(" "),a("p",[e._v("Your favorite programming language is missing? "),a("a",{attrs:{href:"https://vc.hub.msg.team/huethm/web-security-workbook",target:"_blank",rel:"noopener noreferrer"}},[e._v("Add it yourself!"),a("OutboundLink")],1)]),e._v(" "),a("Badge",{attrs:{text:e.$page.frontmatter.owasp}}),e._v(" "),a("h2",{attrs:{id:"background"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[e._v("#")]),e._v(" Background")]),e._v(" "),a("h3",{attrs:{id:"context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[e._v("#")]),e._v(" Context")]),e._v(" "),a("p",[e._v("In Java, objects can be serialized (object into bytes) and deserialized (bytes into object). The "),a("em",[e._v("Serializable()")]),e._v(" interface and its "),a("em",[e._v("readObject()")]),e._v(" and "),a("em",[e._v("writeObject()")]),e._v(" methods must be used to make an object serializable. The "),a("em",[e._v("ObjectInputStream.readObject()")]),e._v(" function starts the deserialization process and executes the corresponding "),a("em",[e._v("readObject()")]),e._v(" method.")]),e._v(" "),a("h3",{attrs:{id:"problems"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#problems"}},[e._v("#")]),e._v(" Problems")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("Attacker can recognize serialized objects easily")]),e._v(" "),a("ul",[a("li",[e._v("Through the first characters\n"),a("ul",[a("li",[e._v("In hexadezimal: "),a("em",[e._v("aced")])]),e._v(" "),a("li",[e._v("In base64: "),a("em",[e._v("rO0")])])])]),e._v(" "),a("li",[e._v("Or through the "),a("em",[e._v("application/x-java-serialized-object")]),e._v(" configuration of the "),a("em",[e._v("Content-type")]),e._v(" HTTP header")])])]),e._v(" "),a("li",[a("strong",[e._v("Type casting after executed ater the serialization")]),e._v(" "),a("ul",[a("li",[e._v("Java always deserializes the objects if the corresponding class was found within the project")]),e._v(" "),a("li",[e._v("Attackers can make use of potentially dangerous "),a("em",[e._v("readObject")]),e._v(" methods (see code example below) to execute commandos")]),e._v(" "),a("li",[e._v("Type casting error is thrown after the class constructor is already executed")])])])]),e._v(" "),a("p",[e._v("@"),a("a",{attrs:{href:"@/vpr/owasp2021/A8-SoftwareAndDataIntegrityFailures/scripts/ExploitClass.java"}},[e._v("code")])]),e._v(" "),a("h3",{attrs:{id:"solutions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#solutions"}},[e._v("#")]),e._v(" Solutions")]),e._v(" "),a("ul",[a("li",[e._v("To secure the deserialization a "),a("strong",[e._v('"Look Ahead Approach"')]),e._v(" is required\n"),a("ul",[a("li",[e._v("The object's class is evaluated "),a("strong",[e._v("before")]),e._v(" the creation process is started")])])]),e._v(" "),a("li",[e._v("Serialized objects could be encrypted to only allow correctly encrypted ones to be deserialized")])]),e._v(" "),a("h2",{attrs:{id:"technology"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#technology"}},[e._v("#")]),e._v(" Technology")]),e._v(" "),a("p",[e._v("How to secure deserialization in Java can be found in this "),a("a",{attrs:{href:"https://github.com/moritzhuether/mastersthesis/tree/main/GeneralJava/08-InsecureDeserialization/main/src/main",target:"_blank",rel:"noopener noreferrer"}},[e._v("code example"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"java"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java"}},[e._v("#")]),e._v(" Java")]),e._v(" "),a("p",[e._v("The library "),a("a",{attrs:{href:"https://github.com/ikkisoft/SerialKiller",target:"_blank",rel:"noopener noreferrer"}},[e._v("Serial Killer"),a("OutboundLink")],1),e._v(" can be used, however its usage is "),a("strong",[e._v("not")]),e._v(" recommended because of its complicated configuration file.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Library")]),e._v(" "),a("th",[e._v("Solution")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Java only")]),e._v(" "),a("td",[e._v('"Look Ahead" '),a("a",{attrs:{href:"https://github.com/moritzhuether/mastersthesis/blob/main/GeneralJava/08-InsecureDeserialization/main/src/main/LookAheadObjectInputStream.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("custom implementation"),a("OutboundLink")],1)])]),e._v(" "),a("tr",[a("td",[e._v("Serial Killer")]),e._v(" "),a("td",[e._v("Configuration of a white- and blacklist of allowed classes")])]),e._v(" "),a("tr",[a("td",[e._v("Apache Commons IO")]),e._v(" "),a("td",[a("em",[e._v("ValidatingObjectInputStream")]),e._v(" objekc requires array of allowed classes before deserialization")])])])])],1)}),[],!1,null,null,null);t.default=s.exports}}]);