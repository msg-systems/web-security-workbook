(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{466:function(e,t,o){"use strict";o.r(t);var s=o(65),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"page-title"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[e._v("#")]),e._v(" "+e._s(e.$page.title))]),e._v(" "),o("p",[e._v("In order to implement session cookies securely, "),o("strong",[e._v("cookies have to be secured")]),e._v(" and the "),o("strong",[e._v("Session Management")]),e._v(" needs to e implemented securely.")]),e._v(" "),o("Badge",{attrs:{text:e.$page.frontmatter.owasp}}),e._v(" "),o("h2",{attrs:{id:"background"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[e._v("#")]),e._v(" Background")]),e._v(" "),o("h3",{attrs:{id:"context"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[e._v("#")]),e._v(" Context")]),e._v(" "),o("p",[e._v("A cookie should be hardened based on the following requirements by OWASP:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("HttpOnly")]),e._v(": The cookie cannot be accessed on the client side (for example trough XSS attacks)")]),e._v(" "),o("li",[o("code",[e._v("Secure")]),e._v(": The cookie will only be attached if its a HTTPS request")]),e._v(" "),o("li",[o("code",[e._v("SameSite")]),e._v(": Defines whether the cookie is send in Cross-Site requests or not")]),e._v(" "),o("li",[o("code",[e._v("Domain")]),e._v(": Used to restrict the cookie for certain sub domains")]),e._v(" "),o("li",[o("code",[e._v("Path")]),e._v(": Can restrict the access of the cookie for certain paths")]),e._v(" "),o("li",[o("code",[e._v("Max-age")]),e._v("/"),o("code",[e._v("Expires")]),e._v(": Sets when a cookie is deleted")])]),e._v(" "),o("h3",{attrs:{id:"problems"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#problems"}},[e._v("#")]),e._v(" Problems")]),e._v(" "),o("ul",[o("li",[e._v("Above requirements need to be implemented and configured for the corresponding web application")]),e._v(" "),o("li",[e._v("Session management also needs to be considered (creation of session ID, timeouts, storage of session information)")])]),e._v(" "),o("h3",{attrs:{id:"solution"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#solution"}},[e._v("#")]),e._v(" Solution")]),e._v(" "),o("ul",[o("li",[e._v("Usage of libraries or framework native implementations")])]),e._v(" "),o("h2",{attrs:{id:"technology"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#technology"}},[e._v("#")]),e._v(" Technology")]),e._v(" "),o("h3",{attrs:{id:"express"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#express"}},[e._v("#")]),e._v(" Express")]),e._v(" "),o("p",[e._v("In Express the library "),o("a",{attrs:{href:"https://www.npmjs.com/package/cookie-session",target:"_blank",rel:"noopener noreferrer"}},[e._v("cookie-session"),o("OutboundLink")],1),e._v(" should be used.")]),e._v(" "),o("ul",[o("li",[e._v("The cookie should be renamed from "),o("code",[e._v("express:sess")]),e._v(" into something generic like "),o("em",[e._v("sessionID")])]),e._v(" "),o("li",[e._v("Cookies are only protected with "),o("code",[e._v("secure")]),e._v(" and "),o("code",[e._v("HttpOnly")])]),e._v(" "),o("li",[e._v("Uses SHA1 per default, should be changed to for example SHA256 (see this "),o("a",{attrs:{href:"https://github.com/msg-systems/web-security-workbookhttps://github.com/msg-systems/web-security-workbook/blob/main/code-examples/Express/07-IdentificationandAuthenticationFailures/cookie-session.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("code example"),o("OutboundLink")],1),e._v(")")])]),e._v(" "),o("h3",{attrs:{id:"spring-boot"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot"}},[e._v("#")]),e._v(" Spring Boot")]),e._v(" "),o("p",[e._v("Spring Security adds session cookies to Spring Boot applications per default.")]),e._v(" "),o("ul",[o("li",[e._v("The cookie should also be renamed from "),o("code",[e._v("JSESSIONID")]),e._v(" to a more generic name")]),e._v(" "),o("li",[o("code",[e._v("HttpOnly")]),e._v(" is set to true")]),e._v(" "),o("li",[o("code",[e._v("Secure")]),e._v(" defaults to false")]),e._v(" "),o("li",[e._v("Session ID is a version four UUID and therefore secure")])])],1)}),[],!1,null,null,null);t.default=r.exports}}]);