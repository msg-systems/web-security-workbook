(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{457:function(e,t,r){"use strict";r.r(t);var a=r(65),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"page-title"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[e._v("#")]),e._v(" "+e._s(e.$page.title))]),e._v(" "),r("p",[e._v(e._s(e.$page.frontmatter.excerpt))]),e._v(" "),r("Badge",{attrs:{text:e.$page.frontmatter.owasp}}),e._v(" "),r("h2",{attrs:{id:"background"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[e._v("#")]),e._v(" Background")]),e._v(" "),r("h3",{attrs:{id:"context"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[e._v("#")]),e._v(" Context")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://owasp.org/www-project-secure-headers/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP"),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://infosec.mozilla.org/guidelines/web_security",target:"_blank",rel:"noopener noreferrer"}},[e._v("Mozilla"),r("OutboundLink")],1),e._v(", as well as different sources in the literature, define HTTP headers, that increase security:")]),e._v(" "),r("table",[r("thead",[r("tr",[r("th",[e._v("Header")]),e._v(" "),r("th",[e._v("Description")]),e._v(" "),r("th",[e._v("Recommended Configuration")])])]),e._v(" "),r("tbody",[r("tr",[r("td",[e._v("HTTP Strict Transport Security (HSTS)")]),e._v(" "),r("td",[e._v("Enforces HTTPS. "),r("a",{attrs:{href:"https://hstspreload.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("preload"),r("OutboundLink")],1),e._v(" even enforces it on the first open of the website")]),e._v(" "),r("td",[e._v("max-age: 6307200, includeSubDomains,")])]),e._v(" "),r("tr",[r("td",[e._v("X-Frame-Options")]),e._v(" "),r("td",[e._v("Disallows "),r("em",[e._v("iframe")]),e._v("'s from rendering to prevent Clickjacking. However: Only relevant in older browsers that don't use the Content-Security-Policy")]),e._v(" "),r("td",[e._v("deny / sameorigin")])]),e._v(" "),r("tr",[r("td",[e._v("X-Content-Type-Options")]),e._v(" "),r("td",[e._v("Will prevent browser from MIME-sniffing")]),e._v(" "),r("td",[e._v("nosniff")])]),e._v(" "),r("tr",[r("td",[e._v("Content-Security-Policy")]),e._v(" "),r("td",[e._v("Allows setting of "),r("em",[e._v("Directives")]),e._v(", which define what content can be loaded from which source")]),e._v(" "),r("td",[e._v("As restrictive as possible. Whitelisting!")])]),e._v(" "),r("tr",[r("td",[e._v("Referrer-Policy")]),e._v(" "),r("td",[e._v("Sets the "),r("em",[e._v("Referer")]),e._v(" header")]),e._v(" "),r("td",[e._v("no-referrer / same-origin")])]),e._v(" "),r("tr",[r("td",[e._v("Cache-Control")]),e._v(" "),r("td",[e._v("Defines how long data is cached")]),e._v(" "),r("td",[e._v("no-cache, no-store, must-revalidate, max-age=0")])]),e._v(" "),r("tr",[r("td",[e._v("Pragma")]),e._v(" "),r("td",[e._v("No-chache alternative for HTTP/1.0")]),e._v(" "),r("td",[e._v("no-cache")])])])]),e._v(" "),r("h3",{attrs:{id:"problems"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#problems"}},[e._v("#")]),e._v(" Problems")]),e._v(" "),r("ul",[r("li",[e._v("Not setting certain HTTP headers reduces the security")]),e._v(" "),r("li",[e._v("Offers vulnerabilities to further attacks")])]),e._v(" "),r("h3",{attrs:{id:"solutions"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#solutions"}},[e._v("#")]),e._v(" Solutions")]),e._v(" "),r("ul",[r("li",[e._v("Use libraries that offer secure default configurations")]),e._v(" "),r("li",[e._v("Usage of "),r("a",{attrs:{href:"https://securityheaders.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Security Headers"),r("OutboundLink")],1)])]),e._v(" "),r("h2",{attrs:{id:"technology"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#technology"}},[e._v("#")]),e._v(" Technology")]),e._v(" "),r("p",[e._v("In Express one can use "),r("a",{attrs:{href:"https://www.npmjs.com/package/helmet",target:"_blank",rel:"noopener noreferrer"}},[e._v("helmet"),r("OutboundLink")],1),e._v(" and in Spring Boot one can use "),r("a",{attrs:{href:"https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/headers.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Spring Security"),r("OutboundLink")],1),e._v(". The following table contains their configurations.")]),e._v(" "),r("table",[r("thead",[r("tr",[r("th",[e._v("Header")]),e._v(" "),r("th",[e._v("Express "),r("em",[e._v("helmet")])]),e._v(" "),r("th",[e._v("Express "),r("em",[e._v("nocache")])]),e._v(" "),r("th",[e._v("Spring Boot "),r("em",[e._v("Spring Security")])])])]),e._v(" "),r("tbody",[r("tr",[r("td",[e._v("HSTS")]),e._v(" "),r("td",[e._v("max-age=15552000; includeSubDomains")]),e._v(" "),r("td"),e._v(" "),r("td",[e._v("max-age=31536000; includeSubDomains")])]),e._v(" "),r("tr",[r("td",[e._v("X-Frame-Options")]),e._v(" "),r("td",[e._v("sameorigin")]),e._v(" "),r("td"),e._v(" "),r("td",[e._v("deny")])]),e._v(" "),r("tr",[r("td",[e._v("Content-Security-Policy")]),e._v(" "),r("td",[e._v("default-src ’self’; base-uri ’self’; block-all-mixed-content; font-src ’self’ https: data:; frame-ancestors ’self’; img-src ’self’ data:; object-src ’none’; script-src ’self’; script-src-attr ’none’; style-src ’self’ https: ’unsafe-inline’; upgrade-insecure-requests")]),e._v(" "),r("td"),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("Referrer-Policy")]),e._v(" "),r("td",[e._v("no-referrer")]),e._v(" "),r("td"),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("X-XSS-Protection")]),e._v(" "),r("td",[e._v("0")]),e._v(" "),r("td"),e._v(" "),r("td",[e._v("1; mode=block")])]),e._v(" "),r("tr",[r("td",[e._v("Cache-Control")]),e._v(" "),r("td"),e._v(" "),r("td",[e._v("no-store, no-cache, muste-revalidate, procy-revalidate")]),e._v(" "),r("td",[e._v("no-cache, no-store, max-age=0, must-revalidate")])]),e._v(" "),r("tr",[r("td",[e._v("Expires")]),e._v(" "),r("td"),e._v(" "),r("td",[e._v("0")]),e._v(" "),r("td",[e._v("0")])]),e._v(" "),r("tr",[r("td",[e._v("Pragma")]),e._v(" "),r("td"),e._v(" "),r("td",[e._v("no-cache")]),e._v(" "),r("td",[e._v("no-cache")])]),e._v(" "),r("tr",[r("td",[e._v("X-Content-Type-Options")]),e._v(" "),r("td",[e._v("no-sniff")]),e._v(" "),r("td"),e._v(" "),r("td",[e._v("no-sniff")])]),e._v(" "),r("tr",[r("td",[e._v("X-Download-Options")]),e._v(" "),r("td",[e._v("noopen")]),e._v(" "),r("td"),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("X-Permitted-Cross-Domain-Policies")]),e._v(" "),r("td",[e._v("none")]),e._v(" "),r("td"),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("X-DNS-Prefetch-Control")]),e._v(" "),r("td",[e._v("off")]),e._v(" "),r("td"),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("Expect-CT")]),e._v(" "),r("td",[e._v("max-age=86400")]),e._v(" "),r("td"),e._v(" "),r("td")])])]),e._v(" "),r("h3",{attrs:{id:"express"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#express"}},[e._v("#")]),e._v(" Express")]),e._v(" "),r("p",[e._v("When using Express, the library "),r("a",{attrs:{href:"https://www.npmjs.com/package/helmet",target:"_blank",rel:"noopener noreferrer"}},[e._v("helmet"),r("OutboundLink")],1),e._v(" should be used in combination with the library "),r("a",{attrs:{href:"https://www.npmjs.com/package/nocache",target:"_blank",rel:"noopener noreferrer"}},[e._v("nocache"),r("OutboundLink")],1),e._v(". Furthermore, the HSTS header's "),r("code",[e._v("max-age")]),e._v(" could be increased and "),r("code",[e._v("preload")]),e._v(" could be added. No further configurations are required.")]),e._v(" "),r("h3",{attrs:{id:"spring-boot"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot"}},[e._v("#")]),e._v(" Spring Boot")]),e._v(" "),r("div",{staticClass:"custom-block danger"},[r("p",{staticClass:"custom-block-title"},[e._v("DANGER")]),e._v(" "),r("p",[r("strong",[e._v("Spring Security's default configuration includes some mistakes:")])]),e._v(" "),r("ul",[r("li",[e._v("The Content-Security-Policy is missing completely!")]),e._v(" "),r("li",[e._v("Further headers are missing")]),e._v(" "),r("li",[r("strong",[e._v("X-XSS-Protection header is configured incorrectly")]),e._v(", that can cause security issues ("),r("a",{attrs:{href:"https://www.chromestatus.com/feature/5021976655560704",target:"_blank",rel:"noopener noreferrer"}},[e._v("see"),r("OutboundLink")],1),e._v(")")])])])],1)}),[],!1,null,null,null);t.default=s.exports}}]);